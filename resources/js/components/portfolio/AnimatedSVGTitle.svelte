<script lang="ts">
    import { onMount } from "svelte";

    let SVG: any;
    let mask: any;
    let paths;
    let reset: any = null;
    let windowWidth: number;
    export let width = 500;

    onMount( () => {
        paths = SVG?.querySelectorAll('path');
        paths.forEach((path: any) => {
            path.style.strokeDasharray = path.getTotalLength();
            path.style.strokeDashoffset = path.getTotalLength();
        });
        mask?.querySelectorAll('path').forEach( (path: any, i: number) => {
            path.classList.add('fillable');
        });

        window.addEventListener('resize', (e) => {
            width = 500 * (windowWidth/2400);
        })
        
    });

    function resetAnimation() {
        reset = {};
    }

</script>
<svelte:window bind:innerWidth={windowWidth}/>

<div class="lg:w-2/3 w-5/6 max-h-50vh lg:-ml-28">
    <h2 class="text-sm xl:text-lg 2xl:text-2xl mt-10 sm:mt-0 font-mono sm:-mb-5"> Hi, I'm Emilien, a </h2>
    {#key reset}
    <svg  class="w-full" bind:this={SVG}  on:click={resetAnimation} fill="none"xmlns="http://www.w3.org/2000/svg" 
        xmlns:xlink="http://www.w3.org/1999/xlink"  zoomAndPan="magnify" viewBox="0 0 300 89.999999" preserveAspectRatio="xMidYMid meet" version="1.0">
        <defs><g/></defs>
        <g fill="#000000" fill-opacity="1"><g transform="translate(5.364571, 36.616513)"><g><path d="M 29.066406 -27.683594 L 6.921875 -27.683594 C 3.875 -27.683594 1.382812 -25.191406 1.382812 -22.144531 L 1.382812 0 L 6.921875 0 L 6.921875 -11.074219 L 29.066406 -11.074219 L 29.066406 -16.609375 L 6.921875 -16.609375 L 6.921875 -22.144531 L 29.066406 -22.144531 Z M 29.066406 -27.683594 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(35.814375, 36.616513)"><g><path d="M 23.53125 0 C 26.574219 0 29.066406 -2.492188 29.066406 -5.535156 L 29.066406 -27.683594 L 23.53125 -27.683594 L 23.53125 -5.535156 L 6.921875 -5.535156 L 6.921875 -27.683594 L 1.382812 -27.683594 L 1.382812 -5.535156 C 1.382812 -2.492188 3.875 0 6.921875 0 Z M 23.53125 0 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(66.26418, 36.616513)"><g><path d="M 29.066406 0 L 29.066406 -5.535156 L 6.921875 -5.535156 L 6.921875 -27.683594 L 1.382812 -27.683594 L 1.382812 -5.535156 C 1.382812 -2.492188 3.875 0 6.921875 0 Z M 29.066406 0 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(96.713985, 36.616513)"><g><path d="M 29.066406 0 L 29.066406 -5.535156 L 6.921875 -5.535156 L 6.921875 -27.683594 L 1.382812 -27.683594 L 1.382812 -5.535156 C 1.382812 -2.492188 3.875 0 6.921875 0 Z M 29.066406 0 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(127.16379, 36.616513)"><g><path d="M 13.839844 -11.074219 L 13.839844 -16.609375 L 1.382812 -16.609375 L 1.382812 -11.074219 Z M 13.839844 -11.074219 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(142.388692, 36.616513)"><g><path d="M 29.066406 -27.683594 L 6.921875 -27.683594 C 3.875 -27.683594 1.382812 -25.191406 1.382812 -22.144531 L 1.382812 -16.609375 C 1.382812 -13.5625 3.875 -11.074219 6.921875 -11.074219 L 23.53125 -11.074219 L 23.53125 -5.535156 L 1.382812 -5.535156 L 1.382812 0 L 23.53125 0 C 26.574219 0 29.066406 -2.492188 29.066406 -5.535156 L 29.066406 -11.074219 C 29.066406 -14.117188 26.574219 -16.609375 23.53125 -16.609375 L 6.921875 -16.609375 L 6.921875 -22.144531 L 29.066406 -22.144531 Z M 29.066406 -27.683594 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(172.838497, 36.616513)"><g><path d="M 29.066406 -27.683594 L 1.382812 -27.683594 L 1.382812 -22.144531 L 12.457031 -22.144531 L 12.457031 0 L 17.992188 0 L 17.992188 -22.144531 L 29.066406 -22.144531 Z M 29.066406 -27.683594 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(203.288302, 36.616513)"><g><path d="M 6.921875 -27.683594 C 3.875 -27.683594 1.382812 -25.191406 1.382812 -22.144531 L 1.382812 0 L 6.921875 0 L 6.921875 -11.074219 L 23.53125 -11.074219 L 23.53125 0 L 29.066406 0 L 29.066406 -22.144531 C 29.066406 -25.191406 26.574219 -27.683594 23.53125 -27.683594 Z M 6.921875 -22.144531 L 23.53125 -22.144531 L 23.53125 -16.609375 L 6.921875 -16.609375 Z M 6.921875 -22.144531 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(233.738107, 36.616513)"><g><path d="M 29.066406 0 L 29.066406 -5.535156 L 6.921875 -5.535156 L 6.921875 -22.144531 L 29.066406 -22.144531 L 29.066406 -27.683594 L 6.921875 -27.683594 C 3.875 -27.683594 1.382812 -25.191406 1.382812 -22.144531 L 1.382812 -5.535156 C 1.382812 -2.492188 3.875 0 6.921875 0 Z M 29.066406 0 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(264.187911, 36.616513)"><g><path d="M 29.066406 -27.683594 L 22.421875 -27.683594 C 21.660156 -27.683594 20.96875 -27.40625 20.414062 -26.851562 L 10.171875 -16.609375 L 6.921875 -16.609375 L 6.921875 -27.683594 L 1.382812 -27.683594 L 1.382812 0 L 6.921875 0 L 6.921875 -11.074219 L 10.171875 -11.074219 L 20.414062 -0.832031 C 20.96875 -0.277344 21.660156 0 22.421875 0 L 29.066406 0 L 29.066406 -5.535156 L 23.53125 -5.535156 L 15.226562 -13.839844 L 23.53125 -22.144531 L 29.066406 -22.144531 Z M 29.066406 -27.683594 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(1.60567, 78.736451)"><g><path d="M 35.414062 -33.726562 L 8.433594 -33.726562 C 4.722656 -33.726562 1.6875 -30.691406 1.6875 -26.984375 L 1.6875 -6.746094 C 1.6875 -3.035156 4.722656 0 8.433594 0 L 35.414062 0 L 35.414062 -6.746094 L 8.433594 -6.746094 L 8.433594 -13.492188 L 35.414062 -13.492188 L 35.414062 -20.238281 L 8.433594 -20.238281 L 8.433594 -26.984375 L 35.414062 -26.984375 Z M 35.414062 -33.726562 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(38.704557, 78.736451)"><g><path d="M 8.433594 0 L 8.433594 -22.21875 L 29.640625 -1.011719 C 30.269531 -0.378906 31.113281 0 32.042969 0 C 33.898438 0 35.414062 -1.519531 35.414062 -3.371094 L 35.414062 -33.726562 L 28.667969 -33.726562 L 28.667969 -11.511719 L 7.460938 -32.714844 C 6.828125 -33.347656 5.988281 -33.726562 5.058594 -33.726562 C 3.203125 -33.726562 1.6875 -32.210938 1.6875 -30.355469 L 1.6875 0 Z M 8.433594 0 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(75.803444, 78.736451)"><g><path d="M 35.414062 -33.726562 L 8.433594 -33.726562 C 4.722656 -33.726562 1.6875 -30.691406 1.6875 -26.984375 L 1.6875 -6.746094 C 1.6875 -3.035156 4.722656 0 8.433594 0 L 28.667969 0 C 32.421875 0 35.414062 -3.078125 35.414062 -6.746094 L 35.414062 -20.238281 L 15.179688 -20.238281 L 15.179688 -13.492188 L 28.667969 -13.492188 L 28.667969 -6.746094 L 8.433594 -6.746094 L 8.433594 -26.984375 L 35.414062 -26.984375 Z M 35.414062 -33.726562 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(112.902332, 78.736451)"><g><path d="M 35.414062 0 L 35.414062 -6.746094 L 21.921875 -6.746094 L 21.921875 -26.984375 L 35.414062 -26.984375 L 35.414062 -33.726562 L 1.6875 -33.726562 L 1.6875 -26.984375 L 15.179688 -26.984375 L 15.179688 -6.746094 L 1.6875 -6.746094 L 1.6875 0 Z M 35.414062 0 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(150.001219, 78.736451)"><g><path d="M 8.433594 0 L 8.433594 -22.21875 L 29.640625 -1.011719 C 30.269531 -0.378906 31.113281 0 32.042969 0 C 33.898438 0 35.414062 -1.519531 35.414062 -3.371094 L 35.414062 -33.726562 L 28.667969 -33.726562 L 28.667969 -11.511719 L 7.460938 -32.714844 C 6.828125 -33.347656 5.988281 -33.726562 5.058594 -33.726562 C 3.203125 -33.726562 1.6875 -32.210938 1.6875 -30.355469 L 1.6875 0 Z M 8.433594 0 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(187.100106, 78.736451)"><g><path d="M 35.414062 -33.726562 L 8.433594 -33.726562 C 4.722656 -33.726562 1.6875 -30.691406 1.6875 -26.984375 L 1.6875 -6.746094 C 1.6875 -3.035156 4.722656 0 8.433594 0 L 35.414062 0 L 35.414062 -6.746094 L 8.433594 -6.746094 L 8.433594 -13.492188 L 35.414062 -13.492188 L 35.414062 -20.238281 L 8.433594 -20.238281 L 8.433594 -26.984375 L 35.414062 -26.984375 Z M 35.414062 -33.726562 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(224.198994, 78.736451)"><g><path d="M 35.414062 -33.726562 L 8.433594 -33.726562 C 4.722656 -33.726562 1.6875 -30.691406 1.6875 -26.984375 L 1.6875 -6.746094 C 1.6875 -3.035156 4.722656 0 8.433594 0 L 35.414062 0 L 35.414062 -6.746094 L 8.433594 -6.746094 L 8.433594 -13.492188 L 35.414062 -13.492188 L 35.414062 -20.238281 L 8.433594 -20.238281 L 8.433594 -26.984375 L 35.414062 -26.984375 Z M 35.414062 -33.726562 "/></g></g></g><g fill="#000000" fill-opacity="1"><g transform="translate(261.297893, 78.736451)"><g><path d="M 35.414062 -26.984375 C 35.414062 -30.691406 32.378906 -33.726562 28.667969 -33.726562 L 1.6875 -33.726562 L 1.6875 0 L 8.433594 0 L 8.433594 -13.492188 L 12.394531 -13.492188 L 24.875 -1.011719 C 25.550781 -0.335938 26.390625 0 27.320312 0 L 35.414062 0 L 35.414062 -6.746094 L 28.667969 -6.746094 L 21.921875 -13.492188 L 28.667969 -13.492188 C 32.378906 -13.492188 35.414062 -16.527344 35.414062 -20.238281 Z M 28.667969 -26.984375 L 28.667969 -20.238281 L 8.433594 -20.238281 L 8.433594 -26.984375 Z M 28.667969 -26.984375 "/></g></g>
        </g>
    </svg>
    {/key}
    <h3 class="text-sm xl:text-lg 2xl:text-2xl font-mono"> the best option for SMBs, startups and individuals</h3>
</div>


<style>
    :root {
        --svg-title-aspectratio: 747/484;
        --svg-dash-length: 720px;
    }

    path {
        aspect-ratio: var(--svg-title-aspectratio);
        fill: none;
        stroke-dasharray: var(--svg-dash-length);
        stroke-dashoffset: var(--svg-dash-length);
        stroke: var(--color-text);
        animation: reveal 4s ease-in-out both;
        width: 60%;
    }

    mask {
        fill: var(--color-text)
    }

    rect {
        fill: var(--color-background);
    }

    @keyframes reveal {
        50% {
            stroke-dashoffset: 0;
            fill: var(--color-background);
        }
        100% {
            fill: var(--color-text);
        }
    }
</style>